# Default deny ingress in argocd namespace (egress unrestricted â€” K8s API ClusterIP
# cannot be reliably targeted by NetworkPolicy on k3s)
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny-ingress
  namespace: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
---
# Allow intra-namespace communication
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-intra-namespace
  namespace: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
  ingress:
    - from:
        - podSelector: {}
